#


# 主題三:存取控制與身分認證


## 存取控制的基本需求


### 安全性
組織政策要確保只有得到授權的人可以讀取機密的資訊，修改資料或程式。

確保使用者不會輕易造成系統無法運作。

### 可用性
存取控制的機制應讓Uesr易於瞭解。

並且儘量不影響他們的正常工作方式與習慣。

存取控制的機制要能夠每次都如預期的運作。

### 擴展性
一個組織的人員、系統或工作量增加時，存取控制的機制不應隨之變為過度複雜。

以致影響系統效能與行政效率。

## 存取控制的主要概念

### 責任分擔 (separation of duties)
應該避免讓一個人完整的知道或持有一個秘密的資訊或流程。

### 最低權限 (least privilege)
每人只擁有足以完成工作的最低權限。

### 知的必要性 (need-to-know)
每人對秘密資訊「知的權利」端視其所負責業務的需要性。

### 資訊分類 (information classification)
使用者(人)與被使用者(系統或資料)間應有清楚的權限對應關係。

## 存取控制的類別

### 預防性
遏止沒有授權的行動發生。

### 偵測性
發現非授權者入侵的證據。

### 指導性
為使系統符合安全政策，依照安全指令作業，並執行安全工作。

### 嚇阻性
使入侵者了解設施之規範，如果侵入將會有嚴重後果。

### 復原性
在系統無法運作時，回復系統之正常功能。

## 存取控制的威脅

### 拒絕服務 (denial of service)
### 緩衝區溢位 (buffer overflow)
### 惡意程式 (malware)
### 密碼破解 (password cracker)
### 欺騙 (spoofing)
### 中間監看 (sniffer)
### 垃圾搜尋 (dumpster diving)
### 窺視 (shoulder surfing)
### 未經授權之資料探勘 (unauthorized data mining)
### 電子訊號外洩 (emanation)
### 物件重用 (object reuse)
### 資料剩磁 (data remanence)

## 實體與虛擬的威脅
### 偷竊
偷竊是存取控制的最大威脅。

### 入侵
入侵可能是實體或虛擬的，也可能兩者結合。	

### 社交工程
社交工程也常結合實體與虛擬的詐欺。

## 系統存取控制

### 身分
讓使用者擁有一個唯一、可電子讀取的名稱，電腦系統以此識別使用者身分。

>*電子世界中「身分」的類型：

1. 使用者名稱 (username)

2. 各種電子識別證、智慧卡、提款卡等。

3. 銀行的帳戶號碼 (account number) 

4. 生物特徵 (biometrics) 

>*身分應有以下特性：

1. 每位使用者的身分應為唯一。有助於身分認證的進行與責任歸屬的釐清。

2. 身分資料應保持最新，離職員工或已不使用的身分應立刻刪除。

3. 機構內應有選定使用者名稱的政策，以免重複使用或在名稱上洩漏太多訊息。

### 身分認證
確認使用該電子身分者為使用者本人。

>*身分認證的方法

>*所知之事

1. 通關密碼

2. PIN

>*所持之物

1. 公開金鑰

2. 私密金鑰

3. 工具產生單次密碼

4. 智慧卡

5. 智慧卡結合所知之事 – 形成雙重要素認證

>*所具之形

1. 視網膜

2. 指紋與聲紋等

3. 智慧卡、密碼與生物特徵形成三重要素認證

### 授權
系統通過身分認證後，授予使用者的讀、寫、執行、刪除等權限。

### 責任歸屬
能讓已經授權的使用者對自己在系統上的行為負責。


## 單點登錄

1. 使用者在客戶端鍵入使用者名稱與通關密碼

2. 使用者名稱與密碼傳送給認證伺服器

3. 認證伺服器認證使用者身分

4. 認證成功後，身分認證伺服器允許使用者使用應用伺服器。

## Kerberos
### Kerberos (I)

1. 它是麻省理工學院所開發的自由軟體

2. Kerberos 協定建構於對稱式金鑰系統

3. 它的信任第三者稱為 Key Distribution Center (KDC)，包括兩部分：Authentication Server (AS) 與 Ticket Granting Server (TGS)。

4. Kerberos 以票證 (ticket) 為基礎，做為使用者身分的憑證。

5. KDC 擁有網路上密鑰的完整資料庫。而其它成員(客戶或伺服端) 則只擁有自己的密鑰。當網路內任何兩者需要對話時，則由KDC完成身分認證後，發出一個會談金鑰 (session key) 供兩端進行安全通訊。

### Kerberos (II)

1. 使用者在客戶端鍵入使用者名稱與通關密碼；客戶端以one-way function將密碼轉換為客戶端金鑰。

2. 客戶端向AS要求登入系統。

3. 若AS在資料庫中找到使用者，就回覆兩樣東西：a. 一把會談金鑰(以客戶端金鑰加密)，b. 一張票證(以TGS金鑰加密)。 

4. 客戶端解開會談金鑰，用以與TGS會談；但票證只有TGS才能解開。客戶端保存這些東西可重複使用。

5. 當客戶端要使用應用伺服器或其他網路資源時，就以會談金鑰與票證向TGS提出要求。

6. TGS發給客戶端與應用伺服器會談的金鑰與票證，並以應用伺服器的金鑰加密。

7. 客戶端以TGS新發給的會談金鑰與票證與應用伺服器進行相互認證與安全通訊。

## 非同步工具產生單次密碼

1. 使用者向身分認證伺服器要求登入

2. 身分認證伺服器產生一組挑戰隨機碼給使用者

3. 使用者將挑戰隨機碼輸入手持式電子認證工具

4. 手持式電子認證工具以密碼學計算回應值 (亦即通關密碼)

5. 使用者將通關密碼送給身分認證伺服器

6. 認證成功後，身分認證伺服器允許使用者使用應用伺服器。

## 同步電子代符

同步電子代符 (synchronous token) 可以自動產生單次密碼

然而隨身攜帶的電子代符必須與身分認證伺服器之間保持同步

### 同步方法包括：

>*時間基準同步：

電子代符與身分認證伺服器之間保持精準的時間同步，因此在同一個時間，電子代符上顯示的數字 (亦即使用者的單次通關密碼) 與伺服器裡的認證數字相同。

>*事件基準同步：

電子代符每產生一次密碼，代符與伺服器的數字就會同步變更一次。
但若代符產生密碼卻未被使用於系統登入，則代符與伺服器間就會失去同步；此時使用者需要對電腦輸入PIN後，讓兩者重新同步。

## 智慧卡

智慧卡 (smart card) 將晶片嵌入塑膠卡中，是最方便攜帶的電子身分認證工具。

### 智慧卡分類別：

>*接觸式智慧卡 (contact smart cards)：

包括塑膠卡身、晶片、與金屬接觸介面。

卡片要插入讀卡機內，讓智慧卡晶片裡的微處理器與電腦或伺服器建立通訊。

目前台灣的金融卡都是接觸式智慧卡。

>*非接觸式智慧卡 (contactless cards)：

類似接觸式智慧卡，但是介面不是金屬接觸層，而是無線射頻(RF)。

非接觸式智慧卡使用更為方便，台北捷運悠遊卡即為一例。

接觸與非接觸式智慧卡本身都沒有電源，要靠讀卡機以接觸或非接觸方式傳輸電力。

>*兩用智慧卡 (combi-cards)：

是指同一張卡有接觸與非接觸式兩種介面。

部分金融卡與悠遊卡結合成一張聯名卡，就具備兩種介面。

## 智慧卡結構

智慧卡晶片像一台微型電腦，內容包括軟、硬體兩部分。

硬體包括 CPU 和幾種記憶體：RAM 與ROM 分別為暫存與永久儲存之用。

EEPROM其上的資料可修改，但斷電後資料仍然存在。

軟體包括 OS 和應用程式。OS 例如像 Java Card。

## 使用智慧卡的優勢

智慧卡攜帶方便，可以在不增加使用者負擔的情況下做到「雙重要素認證 (two-factor authentication)

智慧卡可以儲存人腦無法記憶的密碼長度，使用者只要記得智慧卡的 PIN

萬一智慧卡遭竊，大部分智慧卡都設計成三次 PIN 輸入錯誤則永遠鎖卡。

有些智慧卡具備公開金鑰 (public key) 的運算能力，如此能讓使用者隨身攜帶電子憑證，執行安全性極高的PKI運算

同時也可以做電子簽章，讓交易具備不可否認性 (non-repudiation)。

## 智慧卡攻擊

智慧卡技術已被使用二十年以上，許多攻擊方式應運而生。

### 智慧卡攻擊 (I)

>*實體侵入式攻擊 (physical invasive attacks)

精密儀器可將晶片電路清晰放大，並以探針搭接在要讀取的金屬接點上

這個作法稱為 micro-probing，可直接讀取記憶體內資料，或用以瞭解加密引擎的設計方法。

這種攻擊所需要的設備所費不貲；因此會進行實體攻擊者大多為了較大經濟利益。

### 智慧卡攻擊 (II)

>*旁道攻擊 (side-channel attacks)

攻擊者在智慧卡正常運作時，輸入特定數值讓晶片計算 (尤其是加解密)

再統計該計算所使用的時間或計算過程中所消耗的電力。

如果統計樣本夠大，就有機會推算出晶片內可能的金鑰密碼。

較有名的旁道攻擊法為 timing attack 與 power attack 等。

>*操弄攻擊 (manipulative attacks)

攻擊者刻意在智慧卡運算環境中加入變數，使軟硬體發生非預期的亂象。

若這些亂象不是智慧卡設計者所考慮到的，攻擊者就有可能取得機密資料。


每當智慧卡在做 PIN 的認證時，攻擊者就刻意升高或降低電壓，使CPU無法完成認證程序。

如果智慧卡程式設計為 default true，攻擊者就能通過認證。

## 智慧卡攻擊 (III)

假設智慧卡執行以下程式(以虛擬程式碼表示)，允許將EEPROM記憶體中位址101到110的十比資料輸出到卡外。

	i = 101;
  
 10 IF ( i > 110 ) GOTO 12

  OUTPUT( mem [i] );

  i = i + 1;

  GOTO 10

12	EXIT	

【操弄攻擊】觀察以上程式，執行 “IF ( i > 110 ) GOTO 12” 這行指令所需花費的時間比其它指令都長，

因為它做一個判斷(i 是否大於110?)之後，還要執行跳行 (GOTO 12)。若攻擊者故意將智慧卡的時鐘頻率(clock rate)調高，

例如從標準的5MHz調升到10MHz，這行指令就無法在一個時鐘週期 (clock cycle)內完成：也許只做了判斷卻沒有完成跳行，

因此永遠離不開循環 (loop)；i 的值會繼續往上增加，因此記憶體中所有的資料都被輸出卡外。

























































































